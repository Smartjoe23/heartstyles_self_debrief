<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Heartstyles Self‑Debrief v2 (Foolproof)</title>
<style>
  :root{
    --bg:#f7f7f8; --ink:#111827; --muted:#6b7280; --line:#e5e7eb; --brand:#2563eb;
    --atl:#e8f7e8; --btl:#ffeaea; --card:#ffffff; --chip:#f3f4f6;
  }
  html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;line-height:1.4}
  header{position:sticky;top:0;background:#fff;border-bottom:1px solid var(--line);z-index:10}
  .wrap{max-width:980px;margin:0 auto;padding:14px}
  h1{font-size:20px;margin:0 0 4px 0}
  h2{font-size:16px;margin:10px 0 8px}
  h3{font-size:14px;margin:10px 0 6px}
  p, label, small{font-size:14px}
  .kicker{color:var(--muted);font-size:12px}
  .card{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:14px;margin:10px 0}
  .row{display:flex;gap:12px;flex-wrap:wrap}
  .col{flex:1 1 260px}
  input[type="text"],input[type="email"],select,textarea{width:100%;padding:10px;border:1px solid var(--line);border-radius:10px;background:#fff;box-sizing:border-box}
  textarea{min-height:80px;resize:vertical}
  .pill{display:inline-block;background:var(--chip);border:1px solid var(--line);padding:4px 8px;border-radius:999px;font-size:12px;margin-right:8px}
  .tabs{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0}
  .tab{border:1px solid var(--line);border-radius:999px;background:#fff;padding:6px 10px;font-size:13px;cursor:pointer}
  .tab.active{background:var(--brand);color:#fff;border-color:var(--brand)}
  .sectionTitle{display:flex;justify-content:space-between;align-items:center;gap:8px}
  .btn{border:1px solid var(--line);background:#fff;border-radius:10px;padding:8px 12px;cursor:pointer;font-size:14px}
  .btn.primary{background:var(--brand);color:#fff;border-color:var(--brand)}
  .btn.small{font-size:12px;padding:6px 10px}
  .hint{color:var(--muted);font-size:12px}
  .grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px}
  @media (max-width:720px){.grid{grid-template-columns:1fr}}
  .sliderRow{display:flex;align-items:center;gap:8px}
  .sliderRow input[type="range"]{flex:1}
  .badge{font-size:12px;background:#eef2ff;color:#3730a3;border:1px solid var(--line);border-radius:8px;padding:2px 8px}
  .atl{background:var(--atl)}
  .btl{background:var(--btl)}
  table{width:100%;border-collapse:collapse}
  th,td{border:1px solid var(--line);padding:6px;vertical-align:top;font-size:13px}
  th{background:#f3f4f6;text-align:left}
  .toast{position:fixed;bottom:12px;right:12px;background:#111827;color:#fff;padding:10px 14px;border-radius:10px;opacity:0;transform:translateY(10px);transition:.2s}
  .toast.show{opacity:1;transform:none}
  .out{white-space:pre-wrap;background:#fff;border:1px solid var(--line);border-radius:8px;padding:10px}
  .danger{color:#b91c1c}
</style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>Heartstyles Self‑Debrief v2 <span class="kicker">Foolproof · Offline · EN</span></h1>
      <div class="row">
        <div class="pill">Quick mode (Quadrants)</div>
        <div class="pill">Detailed mode (16 Styles)</div>
        <div class="pill">Auto‑interpretation & questions</div>
        <div class="pill">Export JSON / Print PDF</div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div class="card">
      <h2>0) About you</h2>
      <div class="row">
        <div class="col"><label>Full name</label><input id="name" type="text" placeholder="e.g., Ana Novak"></div>
        <div class="col"><label>Email (optional)</label><input id="email" type="email" placeholder="e.g., ana@company.com"></div>
        <div class="col"><label>Role</label><input id="role" type="text" value="Key Account Manager · OTC & Trade"></div>
        <div class="col"><label>Market</label><input id="market" type="text" value="Slovenia"></div>
      </div>
      <small class="hint">Data stays in your browser unless you export or print.</small>
    </div>

    <div class="card">
      <div class="sectionTitle">
        <h2>1) Choose input mode</h2>
        <div class="tabs">
          <div class="tab active" id="tabQuick" onclick="setMode('quick')">Quick · Quadrants</div>
          <div class="tab" id="tabDetailed" onclick="setMode('detailed')">Detailed · 16 Styles</div>
        </div>
      </div>

      <!-- Quick Mode -->
      <div id="quick" class="mode">
        <h3>Quadrants · Enter Benchmark & Self (0–100)</h3>
        <div class="grid">
          <div class="atl" style="padding:10px;border-radius:10px">
            <strong>ATL Personal (Humility)</strong>
            <div class="sliderRow"><label class="hint">Benchmark</label><input type="range" min="0" max="100" step="1" id="q_hum_bm" oninput="showVal('q_hum_bm_val',this.value)"><span id="q_hum_bm_val">50</span></div>
            <div class="sliderRow"><label class="hint">Self</label><input type="range" min="0" max="100" step="1" id="q_hum_sf" oninput="showVal('q_hum_sf_val',this.value)"><span id="q_hum_sf_val">50</span></div>
            <button class="btn small" onclick="resetPair('q_hum_bm','q_hum_sf')">I don’t know</button>
          </div>
          <div class="atl" style="padding:10px;border-radius:10px">
            <strong>ATL Others (Love)</strong>
            <div class="sliderRow"><label class="hint">Benchmark</label><input type="range" min="0" max="100" id="q_lov_bm" oninput="showVal('q_lov_bm_val',this.value)"><span id="q_lov_bm_val">50</span></div>
            <div class="sliderRow"><label class="hint">Self</label><input type="range" min="0" max="100" id="q_lov_sf" oninput="showVal('q_lov_sf_val',this.value)"><span id="q_lov_sf_val">50</span></div>
            <button class="btn small" onclick="resetPair('q_lov_bm','q_lov_sf')">I don’t know</button>
          </div>
          <div class="btl" style="padding:10px;border-radius:10px">
            <strong>BTL Personal (Pride)</strong>
            <div class="sliderRow"><label class="hint">Benchmark</label><input type="range" min="0" max="100" id="q_pri_bm" oninput="showVal('q_pri_bm_val',this.value)"><span id="q_pri_bm_val">50</span></div>
            <div class="sliderRow"><label class="hint">Self</label><input type="range" min="0" max="100" id="q_pri_sf" oninput="showVal('q_pri_sf_val',this.value)"><span id="q_pri_sf_val">50</span></div>
            <button class="btn small" onclick="resetPair('q_pri_bm','q_pri_sf')">I don’t know</button>
          </div>
          <div class="btl" style="padding:10px;border-radius:10px">
            <strong>BTL Others (Fear)</strong>
            <div class="sliderRow"><label class="hint">Benchmark</label><input type="range" min="0" max="100" id="q_fea_bm" oninput="showVal('q_fea_bm_val',this.value)"><span id="q_fea_bm_val">50</span></div>
            <div class="sliderRow"><label class="hint">Self</label><input type="range" min="0" max="100" id="q_fea_sf" oninput="showVal('q_fea_sf_val',this.value)"><span id="q_fea_sf_val">50</span></div>
            <button class="btn small" onclick="resetPair('q_fea_bm','q_fea_sf')">I don’t know</button>
          </div>
        </div>
      </div>

      <!-- Detailed Mode -->
      <div id="detailed" class="mode" style="display:none">
        <h3>16 Styles · Enter Benchmark & Self (0–100)</h3>
        <div class="hint">Tip: You can fill only the styles you know; leave others blank.</div>
        <table>
          <thead><tr><th>Quadrant</th><th>Style</th><th>Benchmark</th><th>Self</th></tr></thead>
          <tbody id="styleRows"></tbody>
        </table>
        <div class="row" style="margin-top:8px">
          <button class="btn small" onclick="clearDetailed()">Clear all</button>
          <span class="hint">Allowed range: 0–100. Leave empty if unsure.</span>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="sectionTitle">
        <h2>2) Interpret</h2>
        <button class="btn primary" onclick="interpret()">Run interpretation</button>
      </div>
      <div id="output" class="out">Fill data above and click “Run interpretation”.</div>
    </div>

    <div class="card">
      <div class="sectionTitle">
        <h2>3) Save / Share</h2>
        <div class="row" style="gap:8px">
          <button class="btn" onclick="exportJSON()">Export JSON</button>
          <button class="btn" onclick="copyJSON()">Copy JSON</button>
          <button class="btn" onclick="window.print()">Print / Save PDF</button>
        </div>
      </div>
      <small class="hint">No server. Everything stays on this page until you export or print.</small>
    </div>
  </main>

  <div id="toast" class="toast"></div>

<script>
const styles = [
  {q:"ATL Personal (Humility)", s:"Authentic", type:"ATL"},
  {q:"ATL Personal (Humility)", s:"Transforming", type:"ATL"},
  {q:"ATL Personal (Humility)", s:"Reliable", type:"ATL"},
  {q:"ATL Personal (Humility)", s:"Achieving", type:"ATL"},
  {q:"ATL Others (Love)", s:"Relating", type:"ATL"},
  {q:"ATL Others (Love)", s:"Encouraging", type:"ATL"},
  {q:"ATL Others (Love)", s:"Developing", type:"ATL"},
  {q:"ATL Others (Love)", s:"Compassionate", type:"ATL"},
  {q:"BTL Personal (Pride)", s:"Sarcastic Humour", type:"BTL"},
  {q:"BTL Personal (Pride)", s:"Competitive", type:"BTL"},
  {q:"BTL Personal (Pride)", s:"Controlling", type:"BTL"},
  {q:"BTL Personal (Pride)", s:"Striving", type:"BTL"},
  {q:"BTL Others (Fear)", s:"Approval", type:"BTL"},
  {q:"BTL Others (Fear)", s:"Easily Offended", type:"BTL"},
  {q:"BTL Others (Fear)", s:"Dependent", type:"BTL"},
  {q:"BTL Others (Fear)", s:"Avoiding", type:"BTL"},
];

const detailedBody = document.getElementById('styleRows');
styles.forEach((it,i)=>{
  const row = document.createElement('tr');
  row.innerHTML = `<td>${it.q}</td>
    <td>${it.s}</td>
    <td><input type="number" id="bm_${i}" min="0" max="100" placeholder=""></td>
    <td><input type="number" id="sf_${i}" min="0" max="100" placeholder=""></td>`;
  detailedBody.appendChild(row);
});

function setMode(m){
  document.getElementById('quick').style.display = (m==='quick')?'block':'none';
  document.getElementById('detailed').style.display = (m==='detailed')?'block':'none';
  document.getElementById('tabQuick').classList.toggle('active', m==='quick');
  document.getElementById('tabDetailed').classList.toggle('active', m==='detailed');
  toast(`Mode: ${m}`);
}

function showVal(id,val){ document.getElementById(id).textContent = val; }
function resetPair(a,b){
  document.getElementById(a).value=50; document.getElementById(b).value=50;
  showVal(a+'_val','50'); showVal(b+'_val','50');
}

function getQuickData(){
  const get = id => +document.getElementById(id).value || 0;
  return {
    quadrants:{
      hum:{bm:get('q_hum_bm'), sf:get('q_hum_sf')},
      lov:{bm:get('q_lov_bm'), sf:get('q_lov_sf')},
      pri:{bm:get('q_pri_bm'), sf:get('q_pri_sf')},
      fea:{bm:get('q_fea_bm'), sf:get('q_fea_sf')},
    }
  };
}

function getDetailedData(){
  const arr = styles.map((it,i)=>{
    const bm = document.getElementById('bm_'+i).value;
    const sf = document.getElementById('sf_'+i).value;
    return { ...it, bm: bm===''?null:+bm, sf: sf===''?null:+sf };
  });
  return { styles: arr };
}

function interpret(){
  const modeQuick = document.getElementById('quick').style.display !== 'none';
  let out = [];
  if(modeQuick){
    const q = getQuickData().quadrants;
    out.push("## Snapshot (Quadrants)");
    const items = [
      ["Humility (ATL Personal)", q.hum],
      ["Love (ATL Others)", q.lov],
      ["Pride (BTL Personal)", q.pri],
      ["Fear (BTL Others)", q.fea]
    ];
    items.forEach(([name,val])=>{
      const delta = val.sf - val.bm;
      out.push(`• ${name}: Benchmark ${val.bm} → Self ${val.sf} (Δ ${delta>=0?'+':''}${delta})`);
    });
    out.push("");
    out.push(...interpretQuadrants(q));
  } else {
    const d = getDetailedData().styles;
    const filled = d.filter(x=>x.bm!==null || x.sf!==null);
    if(filled.length===0){ toast("Fill at least one style"); return; }
    out.push("## Snapshot (Styles)");
    filled.forEach(x=>{
      const bm = x.bm ?? "?"; const sf = x.sf ?? "?";
      const delta = (x.bm!=null && x.sf!=null) ? (sf-bm) : null;
      out.push(`• ${x.q} · ${x.s}: Benchmark ${bm} → Self ${sf}${delta===null?'':' (Δ '+(delta>=0?'+':'')+delta+')'}`);
    });
    out.push("");
    out.push(...interpretStyles(filled));
  }
  document.getElementById('output').textContent = out.join('\n');
}

function interpretQuadrants(q){
  let lines = ["### Interpretation & Questions"];
  // Heuristics
  const humD = q.hum.sf - q.hum.bm;
  const lovD = q.lov.sf - q.lov.bm;
  const priD = q.pri.sf - q.pri.bm;
  const feaD = q.fea.sf - q.fea.bm;

  // Flags
  if (priD>5 || q.pri.sf>60) {
    lines.push("• Pride (BTL Personal) rising — risk of Controlling/Striving: micromanagement, perfectionism under KPI pressure.");
    lines.push("  Question: “What would become possible if you trusted your counterpart with one step of the process?”");
    lines.push("  Move: Shift to **Developing / Achieving** — define ‘good enough by Friday’ and delegate one micro‑decision.");
  }
  if (feaD>5 || q.fea.sf>60) {
    lines.push("• Fear (BTL Others) rising — risk of Approval/Avoiding: soft ‘yes’, boundary issues, slow tough talks.");
    lines.push("  Question: “Where did a soft ‘yes’ reduce value? What boundary will you state early next meeting?”");
    lines.push("  Move: Shift to **Authentic / Relating** — clear intent, respectful ‘no’, co‑create alternatives.");
  }
  if (humD<-5 || q.hum.sf<40) {
    lines.push("• Humility (ATL Personal) lower in Self — openness/ownership drops under pressure.");
    lines.push("  Question: “What gets in the way of candour when stakes are high?”");
    lines.push("  Move: Practice **Authentic/Reliable** — name the fact, admit one risk, lock follow‑ups.");
  }
  if (lovD<-5 || q.lov.sf<40) {
    lines.push("• Love (ATL Others) lower in Self — relationship focus diluted by short‑term pressure.");
    lines.push("  Question: “Which buyer needs more ‘time in the account’ this month?”");
    lines.push("  Move: Practice **Relating/Developing** — one value‑adding touch, one coaching moment with partner.");
  }

  if (lines.length===1){
    lines.push("• Balanced snapshot. Pick one ATL to amplify in a real account next 7 days, and one BTL to reduce.");
  }

  // Action plan
  lines.push("");
  lines.push("### 7‑Day Micro Action Plan");
  lines.push("• Target behaviour: ______  →  ______ (BTL → ATL)");
  lines.push("• Account / meeting: ______  • Next move: ______  • Success signal: ______");
  return lines;
}

const qMap = {
  "Sarcastic Humour": {to:"Authentic", ask:"When humour lands badly, what’s the cost? How would plain language sound instead?"},
  "Competitive": {to:"Achieving", ask:"Where did ‘winning the moment’ cost long‑term access? What would a sustainable win look like?"},
  "Controlling": {to:"Developing", ask:"What are you afraid will happen if you let go? Which micro‑decision can you safely delegate?"},
  "Striving": {to:"Reliable/Achieving", ask:"Where did ‘perfect’ delay value? What is ‘good enough by Friday’ for this account?"},
  "Approval": {to:"Authentic/Relating", ask:"Where did saying ‘yes’ shrink margin? What boundary will you state next time?"},
  "Easily Offended": {to:"Compassionate", ask:"Which remark stuck with you? If you reframe intent, what changes?"},
  "Dependent": {to:"Achieving", ask:"What decision fits your mandate today? What’s the smallest ‘own call’ you’ll make this week?"},
  "Avoiding": {to:"Authentic/Developing", ask:"Which tough talk are you postponing? What’s the first sentence you’ll use to open it?"},
};

function interpretStyles(rows){
  let lines = ["### Interpretation & Questions"];
  // Identify top signals
  const atls = rows.filter(r=>r.type==='ATL' && r.sf!=null).sort((a,b)=>b.sf-a.sf).slice(0,2);
  const btls = rows.filter(r=>r.type==='BTL' && r.sf!=null).sort((a,b)=>b.sf-a.sf).slice(0,2);
  if(atls.length){
    lines.push("• Top ATL strengths:");
    atls.forEach(x=>lines.push(`   – ${x.s} (${x.sf}) → Where does this win with accounts? How to repeat next week?`));
  }
  if(btls.length){
    lines.push("• Top BTL risks:");
    btls.forEach(x=>{
      const tip = qMap[x.s];
      if(tip){
        lines.push(`   – ${x.s} (${x.sf}) → Shift to **${tip.to}**. Question: ${tip.ask}`);
      } else {
        lines.push(`   – ${x.s} (${x.sf}) → Identify trigger; choose ATL counterpart.`);
      }
    });
  }
  // Gap-based prompts
  const gapsUp = rows.filter(r=>r.bm!=null && r.sf!=null && (r.sf - r.bm) >= 10);
  const gapsDown = rows.filter(r=>r.bm!=null && r.sf!=null && (r.sf - r.bm) <= -10);
  if(gapsUp.length){
    lines.push("• Self much higher than Benchmark:");
    gapsUp.forEach(x=>lines.push(`   – ${x.s} (Δ +${x.sf - x.bm}) → How do others experience this in real meetings?`));
  }
  if(gapsDown.length){
    lines.push("• Self lower than Benchmark (intent not lived yet):");
    gapsDown.forEach(x=>lines.push(`   – ${x.s} (Δ ${x.sf - x.bm}) → What gets in the way? Where will you test it next?`));
  }
  // Action plan
  lines.push("");
  lines.push("### 7‑Day Micro Action Plan");
  lines.push("• Target behaviour: ______  →  ______ (BTL → ATL)");
  lines.push("• Account / meeting: ______  • Next move: ______  • Success signal: ______");
  return lines;
}

function clearDetailed(){
  styles.forEach((_,i)=>{
    document.getElementById('bm_'+i).value='';
    document.getElementById('sf_'+i).value='';
  });
}

function exportJSON(){
  const data = collectAll();
  const blob = new Blob([JSON.stringify(data,null,2)], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href=url; a.download='heartstyles_self_debrief_v2.json'; a.click();
  setTimeout(()=>URL.revokeObjectURL(url), 500);
}

async function copyJSON(){
  try{
    await navigator.clipboard.writeText(JSON.stringify(collectAll(),null,2));
    toast('Copied JSON ✔');
  }catch(e){ toast('Copy failed'); }
}

function collectAll(){
  const quickOn = document.getElementById('quick').style.display!=='none';
  return {
    meta:{ts:new Date().toISOString()},
    person:{
      name:val('name'), email:val('email'), role:val('role'), market:val('market')
    },
    mode: quickOn?'quick':'detailed',
    quick: quickOn? getQuickData() : null,
    detailed: !quickOn? getDetailedData() : null,
    output: document.getElementById('output').textContent
  };
}

function val(id){const el=document.getElementById(id);return el?el.value.trim():'';}

function toast(msg){
  const t=document.getElementById('toast');
  t.textContent=msg; t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),1800);
}

// Initialize slider values display
['q_hum_bm','q_hum_sf','q_lov_bm','q_lov_sf','q_pri_bm','q_pri_sf','q_fea_bm','q_fea_sf'].forEach(id=>{
  const el=document.getElementById(id); if(el){ showVal(id+'_val', el.value||'50'); }
});
</script>
</body>
</html>
